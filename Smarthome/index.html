<!DOCTYPE html>
<head>

<title>Smart Home</title>
<link rel="stylesheet" type="text/css" href="./css/style.css">
<meta charset="UTF-8">

</head>
<body>

<div id="content">
	<center>
		<div class="analog">
			<div class="analog_img">
				<img src="./images/temp.png" class="sensors">
			</div>
			<div class="analog_title">
				<h2>Temperature</h2>
			</div>
			<hr>
			<div class="analog_value" id="tempValue">
				&nbsp&nbsp32&nbsp<font class="unit">℃</font>
			</div>
		</div>
		<div class="analog">
			<div class="analog_img">
				<img src="./images/light.png" class="sensors" style="width: 35%;">
			</div>
			<div class="analog_title">
				<h2>Brightness</h2>
			</div>
			<hr>
			<div class="analog_value" id="lightValue">
				567
			</div>
		</div>
		<div class="analog">
			<div class="analog_img">
				<img src="./images/elec.png" class="sensors">
			</div>
			<div class="analog_title">
				<h2>Electricity</h2>
			</div>
			<hr>
			<div class="analog_value" id="elecValue">
				&nbsp&nbsp&nbsp305&nbsp<font class="unit">mA</font>
			</div>
		</div>
		<div class="analog">
			<div class="analog_img">
				<img src="./images/people.png" class="sensors">
			</div>
			<div class="analog_title">
				<h2>People</h2>
			</div>
			<hr>
			<div class="analog_value" id="people_con">
				<img src="./images/people_on.png" id="people">
			</div>
		</div>
		<div class="analog">
			<div class="analog_img">
				<img src="./images/co.png" class="sensors" style="width: 40%; top: 25%">
			</div>
			<div class="analog_title">
				<h2>Carbon monoxide</h2>
			</div>
			<hr>
			<div class="analog_value" id="COValue">
				&nbsp&nbsp&nbsp20&nbsp<font class="unit">PPM</font>
			</div>
		</div>
		<p>
		<div class="output">
			<div class="output_title">
				<h2 style="margin-top: 5px;">Fan</h2>
			</div>
			<hr style="margin-top: 0px;">
			<div class="output_img">
				<img src="./images/fan.png" class="sensors" style="width: 55%; top: 5%;">
			</div>
			<div class="output_content">
				<input Onchange="fan(this.value);" type="range" id="fan" style="margin-top: 25%;" value="0" min="0" max="255">
			</div>
		</div>
		<div class="output">
			<div class="output_title">
				<h2 style="margin-top: 5px;">Lighting</h2>
			</div>
			<hr style="margin-top: 0px;">
			<div class="output_img">
				<img src="./images/bulb.png" id="bulb" class="sensors" style="width: 30%; top: 5%;">
			</div>
			<div class="output_content">
				<label class="switch" style="top: 25%;">
				  <input type="checkbox" id="bulb" onclick="blub(this.value);">
				  <div class="slider round"></div>
				</label>
			</div>
		</div>
	</center>
</div>

</body>

<script>

	setup();
	
	var tempValue;
	var lightValue;
	var elecValue;
	var people;
	var COValue;
	var fan;
	var bulb;
	
	// 上排數值顯示
	function loop() {
		if(cpf){
			
			// 溫度
			tempValue = toCelsius(cpf.get("socket a1"));
			document.getElementById("tempValue").innerHTML = '&nbsp&nbsp'+tempValue+'&nbsp<font class="unit">℃</font>';
			// 光敏
			lightValue = cpf.get("socket a0");
			document.getElementById("lightValue").innerHTML = lightValue;
			// 電流
			elecValue = cpf.get("socket a2");
			document.getElementById("elecValue").innerHTML = '&nbsp&nbsp&nbsp'+elecValue+'&nbsp<font class="unit">mA</font>';
			// 人體感測
			people = cpf.get("socket d6");
			if(people = 1) {
				document.getElementById("people").src = './images/people_on.png';
			}else {
				document.getElementById("people").src = './images/people_off.png';
			}
			// 一氧化碳
			COValue = cpf.get("socket a3");
			document.getElementById("COValue").innerHTML = '&nbsp&nbsp&nbsp'+COValue+'&nbsp<font class="unit">PPM</font>';
			
		}
		setTimeout("loop()", 1000);
	}
	
	loop();
	
	// 風扇
	function fan(value) {
		cpf.set("fan", value);
	}
	
	// LED燈
	/*function blub(value) {
		cpf.set("socket d2", value);
	}*/
	
	// Temperature
	function toCelsius(value) {
		var resistance = parseFloat((1023-value) * 10000 / value);
		var temperature = 1 / (Math.log(resistance / 10000) / 3975+1 / 298.15) - 273.15;
		
		return temperature.toFixed(2);
	}

	// cpf setup
	function setup(){
		if(cpf)
			var ret = cpf.setPinMode('["resetPin"],["setPinMode", "analog", 0, "INPUT"],["setPinMode", "analog", 1, "INPUT"],["setPinMode", "analog", 2, "INPUT"],["setPinMode", "analog", 3, "INPUT"],["setPinMode", "digital", 2,"OUTPUT"],["setPinMode", "digital", 3,"OUTPUT"],["setPinMode", "digital", 6,"OUTPUT"]');
			
	}

</script>

</html>

